{% extends '::base.html.twig' %}

{% block body %}
    <div class="row">
        <div class="col-md-8">
            <div>
                <h3>{% trans %}wizard.home.express_yourself{% endtrans %}</h3>
                {{ form_start(formSmallPublication, { attr: {id: 'wizardalley_publicationbundle_add_small_publication'}}) }}
                {{ form_row(formSmallPublication.content) }}
                {{ form_row(formSmallPublication.submit) }}

                {{ form_end(formSmallPublication) }}
            </div>
            <div>
                <h3>{% trans %}wizard.home.your_publication{% endtrans %}</h3>
                <div class="publication-block-wrapper">

                </div>
                <div>
                    <button class="load-more-publication">{% trans %}wizard.utility.load_more{% endtrans %}</button>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="row">
                <h3 class="col-md-12">Suggestion d'amis</h3>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <h3>{% trans %}wizard.home.most_commented{% endtrans %}</h3>
                </div>
                <div class="most-commented-block-wrapper col-md-12">

                </div>
                <div class="col-md-12">
                    <button class="load-more-most-commented">{% trans %}wizard.utility.load_more{% endtrans %}</button>
                </div>
            </div>
            <div class="row">
                <h3 class="col-md-12">{% trans %}wizard.home.informations{% endtrans %}</h3>
                <div class="information-block-wrapper col-md-12">

                </div>
                <div class="col-md-12">
                    <button class="load-more-information">{% trans %}wizard.utility.load_more{% endtrans %}</button>
                </div>
            </div>

        </div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        _$page = 1;
        _$pageInformation = 1;
        _$pageMostCommented = 1;
        loadMore();
        loadMoreInformation();
        loadMoreMostCommented();
        $('.load-more-most-commented').on('click', function () {
            loadMoreMostCommented();
        });
        $('.load-more-publication').on('click', function () {
            loadMore();
        });
        $('.load-more-information').on('click', function () {
            loadMoreInformation();
        });

        function loadMore() {
            $result = util.loadMorePublicationHome(_$page);
            _$page = _$page + 1;
        }
        ;

        function loadMoreInformation() {
            $result = util.loadMoreInfo(_$pageInformation);
            _$pageInformation = _$pageInformation + 1;
        }
        ;
        function loadMoreMostCommented() {
            $result = util.loadMoreMostCommented(_$pageMostCommented);
            _$pageMostCommented = _$pageMostCommented + 1;
        }
        ;

        $('#wizardalley_publicationbundle_add_small_publication').on('submit', function (e) {
            e.preventDefault();
            result = util.ajaxHandle($(this).attr('method'), $(this).serialize(), $(this).attr('action'));
            $('#wizardalley_publicationbundle_add_small_publication textarea').val('');
        });

    </script>
{% endblock %}
